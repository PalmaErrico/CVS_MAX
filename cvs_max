#%%
import os
import csv

# Coppie (input_folder, output_folder, suffisso_nome_file)
input_output_config = [
    ('C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V1', 'C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V1/v1_output_csv', 'v1'),
    ('C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V2', 'C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V2/v2_output_csv', 'v2')
]

# Delimitatore usato nei file .txt
delimiter = '\t'  # cambia se necessario

# Ciclo su ogni configurazione
for input_folder, output_folder, version in input_output_config:
    os.makedirs(output_folder, exist_ok=True)

    for filename in os.listdir(input_folder):
        if filename.endswith('.txt'):
            base_name = os.path.splitext(filename)[0]
            input_path = os.path.join(input_folder, filename)
            output_name = f'u_{base_name}_{version}.csv'
            output_path = os.path.join(output_folder, output_name)

            # Legge il file .txt
            with open(input_path, 'r', encoding='utf-8') as txt_file:
                lines = txt_file.readlines()

            # Scrive il file .csv
            with open(output_path, 'w', newline='', encoding='utf-8') as csv_file:
                writer = csv.writer(csv_file)
                for line in lines:
                    row = line.strip().split(delimiter)
                    writer.writerow(row)

            print(f'Convertito: {input_path} ‚Üí {output_path}')



#%%
#%%
import os
import csv

# Cartelle di input
input_folders = [
    'C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V1/v1_output_csv',
    'C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/V2/v2_output_csv'
]

# File di output finale
output_csv_path = 'C:/Users/Palma/Desktop/DOTTORATO/collaborazione_articoli/ECG_Dataset5/Dataset5/riepilogo_durata_sequenze.csv'

def genera_riepilogo(input_folders, output_csv_path):
    results = []

    for folder in input_folders:
        print(f"\nüîç Analizzando cartella: {folder}")
        if not os.path.exists(folder):
            print(f"‚ö†Ô∏è  Cartella non trovata: {folder}")
            continue

        file_list = os.listdir(folder)
        print(f"  ‚Üí {len(file_list)} file trovati")

        for filename in file_list:
            if filename.endswith('.csv') and filename != os.path.basename(output_csv_path):
                csv_path = os.path.join(folder, filename)

                with open(csv_path, 'r', encoding='utf-8') as f:
                    reader = csv.reader(f)
                    row_count = sum(1 for row in reader)

                if row_count <= 1:
                    print(f"‚ö†Ô∏è  File ignorato (vuoto o solo intestazione): {filename}")
                    continue

                secondi_iniziali = 0
                secondi_finali = (row_count - 1) // 1000

                results.append([
                    filename,
                    secondi_iniziali,
                    secondi_finali,
                    'tag1_domenico',
                    'tag2_Palma_Pietro'
                ])
                print(f"‚úîÔ∏è  Elaborato: {filename} ‚Üí {secondi_finali} secondi")

    if not results:
        print("‚ùå Nessun file valido trovato. Nessun riepilogo creato.")
        return

    with open(output_csv_path, 'w', newline='', encoding='utf-8') as out_file:
        writer = csv.writer(out_file)
        writer.writerow([
            'nome_file_csv',
            'secondo_iniziale',
            'secondo_finale',
            'tag1_domenico',
            'tag2_Palma_Pietro'
        ])
        writer.writerows(results)

    print(f"\n‚úÖ Riepilogo finale creato con {len(results)} file totali:\n{output_csv_path}")

# Esegui la funzione
if __name__ == "__main__":
    genera_riepilogo(input_folders, output_csv_path)
